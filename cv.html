<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dang Van Anh - Curriculum Vitae</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* CV Page Specific Styles - New Layout */
        .cv-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 30px;
            position: relative;
            z-index: 1;
        }

        /* Sidebar */
        .cv-sidebar {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(30px);
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 30px;
            height: fit-content;
            position: sticky;
            top: 20px;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .cv-sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(120, 119, 198, 0.05), rgba(255, 119, 198, 0.05));
            border-radius: 24px;
            z-index: -1;
        }

        .cv-profile {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .cv-profile-image {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 20px;
            border: 3px solid rgba(120, 119, 198, 0.3);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .cv-profile-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .cv-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #7877c6 0%, #ff77c6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .cv-title {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 15px;
        }

        .cv-contact {
            margin-bottom: 30px;
        }

        .cv-contact h3 {
            font-size: 1.1rem;
            color: #ffffff;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .cv-contact-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .cv-contact-item i {
            width: 16px;
            color: #7877c6;
        }

        .cv-skills {
            margin-bottom: 30px;
        }

        .cv-skills h3 {
            font-size: 1.1rem;
            color: #ffffff;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .skill-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .skill-tag {
            background: rgba(120, 119, 198, 0.2);
            border: 1px solid rgba(120, 119, 198, 0.3);
            border-radius: 12px;
            padding: 6px 12px;
            font-size: 0.8rem;
            color: #ffffff;
            transition: all 0.3s ease;
        }

        .skill-tag:hover {
            background: rgba(120, 119, 198, 0.3);
            transform: translateY(-2px);
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            color: #ffffff;
            text-decoration: none;
            font-weight: 500;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            width: 100%;
            justify-content: center;
        }

        .back-button:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: #7877c6;
            box-shadow: 0 15px 40px rgba(120, 119, 198, 0.3);
            transform: translateY(-2px);
        }

        /* Main Content */
        .cv-main {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(30px);
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            display: flex;
            flex-direction: column;
            height: calc(100vh - 40px);
        }

        .cv-main::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(120, 119, 198, 0.05), rgba(255, 119, 198, 0.05));
            z-index: -1;
        }

        .cv-header {
            padding: 25px 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.02);
            flex-shrink: 0;
        }

        .cv-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            color: #ffffff;
            margin-bottom: 8px;
            text-shadow: 0 0 30px rgba(120, 119, 198, 0.5);
            background: linear-gradient(135deg, #7877c6 0%, #ff77c6 50%, #78dbff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .cv-header p {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.8);
            margin: 0;
        }

        /* Enhanced PDF Viewer */
        .pdf-container {
            position: relative;
            flex: 1;
            min-height: 0;
            display: flex;
            flex-direction: column;
            background: #1a1a1a;
        }

        /* PDF Toolbar */
        .pdf-toolbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.05);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            flex-shrink: 0;
        }

        .pdf-toolbar-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .pdf-toolbar-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .pdf-control-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #ffffff;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .pdf-control-btn:hover {
            background: rgba(120, 119, 198, 0.3);
            border-color: #7877c6;
            transform: translateY(-1px);
        }

        .pdf-control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .pdf-viewer-select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #ffffff;
            padding: 8px 12px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pdf-viewer-select:focus {
            outline: none;
            border-color: #7877c6;
            background: rgba(120, 119, 198, 0.1);
        }

        .pdf-viewer-select option {
            background: #2a2a2a;
            color: #ffffff;
        }

        /* PDF Viewer Area */
        .pdf-viewer-area {
            flex: 1;
            position: relative;
            overflow: hidden;
            background: #1a1a1a;
        }

        .pdf-viewer {
            width: 100%;
            height: 100%;
            border: none;
            background: #ffffff;
        }

        .pdf-loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1rem;
            flex-direction: column;
            gap: 20px;
            flex: 1;
        }

        .pdf-loading .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(120, 119, 198, 0.2);
            border-top: 4px solid #7877c6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .pdf-error {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1rem;
            flex-direction: column;
            gap: 20px;
            text-align: center;
            padding: 40px;
        }

        .pdf-error i {
            font-size: 3rem;
            color: #7877c6;
            margin-bottom: 10px;
        }

        .pdf-error .error-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .pdf-error .error-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(120, 119, 198, 0.2);
            border: 1px solid rgba(120, 119, 198, 0.3);
            border-radius: 12px;
            color: #ffffff;
            text-decoration: none;
            font-weight: 500;
            font-size: 0.85rem;
            padding: 10px 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .pdf-error .error-btn:hover {
            background: rgba(120, 119, 198, 0.3);
            border-color: #7877c6;
            transform: translateY(-2px);
        }

        .download-button {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 10px 20px;
            background: rgba(120, 119, 198, 0.2);
            border: 1px solid rgba(120, 119, 198, 0.3);
            border-radius: 12px;
            color: #ffffff;
            text-decoration: none;
            font-weight: 500;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            z-index: 10;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .download-button:hover {
            background: rgba(120, 119, 198, 0.3);
            border-color: #7877c6;
            box-shadow: 0 5px 15px rgba(120, 119, 198, 0.3);
            transform: translateY(-2px);
        }

        /* PDF.js Viewer Styles */
        .pdfjs-viewer {
            width: 100%;
            height: 100%;
            background: #ffffff;
            overflow: auto;
        }

        .pdfjs-canvas-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            min-height: 100%;
        }

        .pdfjs-page {
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            overflow: hidden;
        }

        .pdfjs-page canvas {
            display: block;
            max-width: 100%;
            height: auto;
        }

        .pdfjs-controls {
            position: sticky;
            top: 0;
            background: rgba(255, 255, 255, 0.95);
            padding: 10px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 100;
        }

        .pdfjs-controls button {
            padding: 8px 16px;
            background: #7877c6;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .pdfjs-controls button:hover {
            background: #6a69b8;
        }

        .pdfjs-controls button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .pdfjs-page-info {
            color: #666;
            font-size: 14px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .cv-container {
                grid-template-columns: 300px 1fr;
                gap: 20px;
            }
        }

        @media (max-width: 1024px) {
            .cv-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .cv-sidebar {
                position: relative;
                top: 0;
            }
            
            .cv-main {
                height: calc(100vh - 200px);
                min-height: 600px;
            }
            
            .cv-profile {
                display: flex;
                align-items: center;
                text-align: left;
                gap: 20px;
            }
            
            .cv-profile-image {
                width: 80px;
                height: 80px;
                margin: 0;
            }
            
            .cv-contact {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 20px;
            }
        }

        @media (max-width: 768px) {
            .cv-container {
                padding: 15px;
            }
            
            .cv-sidebar,
            .cv-main {
                padding: 20px;
            }
            
            .cv-header {
                padding: 20px;
            }
            
            .cv-header h1 {
                font-size: 1.8rem;
            }
            
            .cv-profile {
                flex-direction: column;
                text-align: center;
            }
            
            .cv-contact {
                grid-template-columns: 1fr;
            }
            
            .cv-main {
                height: calc(100vh - 250px);
                min-height: 500px;
            }
            
            .download-button {
                top: 10px;
                right: 10px;
                padding: 8px 16px;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            .cv-sidebar,
            .cv-main {
                padding: 15px;
            }
            
            .cv-header {
                padding: 15px;
            }
            
            .cv-header h1 {
                font-size: 1.6rem;
            }
            
            .cv-main {
                height: calc(100vh - 300px);
                min-height: 400px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen">
        <div class="loading-spinner"></div>
    </div>

    <!-- Main Container -->
    <div class="cv-container">
        <!-- Sidebar -->
        <div class="cv-sidebar">
            <!-- Profile Section -->
            <div class="cv-profile">
                <div class="cv-profile-image">
                    <img src="https://via.placeholder.com/120x120/7877c6/ffffff?text=CV" alt="Profile Picture">
                </div>
                <div>
                    <h2 class="cv-name">Dang Van Anh</h2>
                    <p class="cv-title">Software Engineer</p>
                </div>
            </div>

            <!-- Contact Information -->
            <div class="cv-contact">
                <h3><i class="fas fa-address-card"></i> Contact</h3>
                <div class="cv-contact-item">
                    <i class="fas fa-envelope"></i>
                    <span>email@example.com</span>
                </div>
                <div class="cv-contact-item">
                    <i class="fas fa-phone"></i>
                    <span>+84 123 456 789</span>
                </div>
                <div class="cv-contact-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>Ho Chi Minh City, Vietnam</span>
                </div>
                <div class="cv-contact-item">
                    <i class="fab fa-linkedin"></i>
                    <span>linkedin.com/in/yourprofile</span>
                </div>
            </div>

            <!-- Skills -->
            <div class="cv-skills">
                <h3><i class="fas fa-code"></i> Skills</h3>
                <div class="skill-tags">
                    <span class="skill-tag">JavaScript</span>
                    <span class="skill-tag">React</span>
                    <span class="skill-tag">Node.js</span>
                    <span class="skill-tag">Python</span>
                    <span class="skill-tag">SQL</span>
                    <span class="skill-tag">Git</span>
                    <span class="skill-tag">AWS</span>
                    <span class="skill-tag">Docker</span>
                </div>
            </div>

            <!-- Back Button -->
            <a href="index.html" class="back-button">
                <i class="fas fa-arrow-left"></i>
                Back to Links
            </a>
        </div>

        <!-- Main Content -->
        <div class="cv-main">
            <!-- Header -->
            <div class="cv-header">
                <h1>Curriculum Vitae</h1>
                <p>Professional Experience & Skills</p>
            </div>

            <!-- PDF Container -->
            <div class="pdf-container">
                <!-- Download Button -->
                <a href="DANG-VAN-ANH-SMT.pdf" class="download-button" download>
                    <i class="fas fa-download"></i>
                    Download PDF
                </a>
                
                <!-- PDF Toolbar -->
                <div class="pdf-toolbar">
                    <div class="pdf-toolbar-left">
                        <span style="color: rgba(255, 255, 255, 0.8); font-size: 14px;">PDF Viewer:</span>
                        <select class="pdf-viewer-select" id="pdf-viewer-select">
                            <option value="browser">Browser Default</option>
                            <option value="pdfjs">PDF.js Viewer</option>
                            <option value="google">Google Docs Viewer</option>
                            <option value="direct">Direct Link</option>
                        </select>
                    </div>
                    
                    <div class="pdf-toolbar-right">
                        <button class="pdf-control-btn" id="reload-pdf" title="Reload PDF">
                            <i class="fas fa-redo"></i>
                        </button>
                        <button class="pdf-control-btn" id="open-new" title="Open in New Tab">
                            <i class="fas fa-external-link-alt"></i>
                        </button>
                        <button class="pdf-control-btn" id="fullscreen" title="Fullscreen">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                </div>
                
                <!-- PDF Viewer Area -->
                <div class="pdf-viewer-area" id="pdf-viewer-area">
                    <div class="pdf-loading">
                        <div class="spinner"></div>
                        <div>Loading CV...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // PDF Viewer State
        let currentViewer = 'pdfjs';
        let pdfUrl = 'pdf-viewer.php';
        let pdfDirectUrl = 'DANG-VAN-ANH-SMT.pdf';
        let currentPage = 1;
        let totalPages = 1;
        let pdfDoc = null;

        // Initialize CV page
        document.addEventListener('DOMContentLoaded', function() {
            // Hide loading screen
            setTimeout(() => {
                const loadingScreen = document.querySelector('.loading-screen');
                const container = document.querySelector('.cv-container');
                
                if (loadingScreen) {
                    loadingScreen.style.opacity = '0';
                    loadingScreen.style.visibility = 'hidden';
                }
                
                if (container) {
                    container.style.opacity = '1';
                    container.style.visibility = 'visible';
                }
            }, 1000);

            // Initialize PDF viewer
            initPDFViewer();
        });

        function initPDFViewer() {
            // Initialize controls
            initControls();
            
            // Set default viewer in dropdown
            document.getElementById('pdf-viewer-select').value = currentViewer;
            
            // Check if PDF file exists first
            checkPDFAvailability();
        }

        function checkPDFAvailability() {
            const viewerArea = document.getElementById('pdf-viewer-area');
            
            // Show loading while checking
            viewerArea.innerHTML = `
                <div class="pdf-loading">
                    <div class="spinner"></div>
                    <div>Checking PDF availability...</div>
                </div>
            `;
            
            // Try to fetch the PDF file to check if it exists
            fetch(pdfUrl, { method: 'HEAD' })
                .then(response => {
                    if (response.ok) {
                        console.log('PDF file is accessible');
                        loadPDF();
                    } else {
                        throw new Error('PDF file not found');
                    }
                })
                .catch(error => {
                    console.error('PDF availability check failed:', error);
                    showError('PDF file is not accessible. Please check if the file exists and try again.');
                });
        }

        function initControls() {
            // Viewer selector
            document.getElementById('pdf-viewer-select').addEventListener('change', (e) => {
                currentViewer = e.target.value;
                loadPDF();
            });

            // Reload button
            document.getElementById('reload-pdf').addEventListener('click', () => {
                loadPDF();
            });

            // Open in new tab
            document.getElementById('open-new').addEventListener('click', () => {
                window.open(pdfUrl, '_blank');
            });

            // Fullscreen button
            document.getElementById('fullscreen').addEventListener('click', () => {
                toggleFullscreen();
            });
        }

        function loadPDF() {
            const viewerArea = document.getElementById('pdf-viewer-area');
            
            // Show loading
            viewerArea.innerHTML = `
                <div class="pdf-loading">
                    <div class="spinner"></div>
                    <div>Loading CV...</div>
                </div>
            `;

            // Load based on selected viewer
            switch(currentViewer) {
                case 'pdfjs':
                    loadWithPDFjs();
                    break;
                case 'google':
                    loadWithGoogleDocs();
                    break;
                case 'direct':
                    loadWithDirectLink();
                    break;
                case 'browser':
                default:
                    loadWithBrowser();
                    break;
            }
        }

        function loadWithBrowser() {
            const viewerArea = document.getElementById('pdf-viewer-area');
            
            try {
                // Create a container for the PDF viewer
                const container = document.createElement('div');
                container.className = 'pdf-viewer-container';
                container.style.width = '100%';
                container.style.height = '100%';
                container.style.background = '#ffffff';
                container.style.overflow = 'auto';
                
                // Try iframe first
                const iframe = document.createElement('iframe');
                iframe.className = 'pdf-viewer';
                iframe.style.width = '100%';
                iframe.style.height = '100%';
                iframe.style.border = 'none';
                iframe.style.background = '#ffffff';
                
                // Use PHP script for better headers, fallback to direct URL
                const urlToUse = pdfUrl;
                iframe.src = urlToUse + '#toolbar=1&navpanes=1&scrollbar=1&view=FitH&pagemode=none';
                
                container.appendChild(iframe);
                viewerArea.innerHTML = '';
                viewerArea.appendChild(container);
                
                // Check if iframe loaded successfully
                setTimeout(() => {
                    try {
                        if (iframe.contentDocument && iframe.contentDocument.body) {
                            const bodyContent = iframe.contentDocument.body.innerHTML;
                            // Check if it's actually showing PDF content
                            if (bodyContent.includes('pdf') || bodyContent.includes('PDF') || 
                                bodyContent.includes('application/pdf') || bodyContent.length > 100) {
                                console.log('Browser PDF viewer loaded successfully');
                                return;
                            } else {
                                throw new Error('Iframe content is not PDF');
                            }
                        } else {
                            throw new Error('Iframe content not accessible');
                        }
                    } catch (e) {
                        console.log('Iframe failed, trying object tag...');
                        loadWithObject(container);
                    }
                }, 3000);
                
            } catch (error) {
                console.log('Iframe creation failed, trying object tag...');
                loadWithObject();
            }
        }

        function loadWithObject(container = null) {
            const viewerArea = container || document.getElementById('pdf-viewer-area');
            
            try {
                const object = document.createElement('object');
                object.className = 'pdf-viewer';
                object.data = pdfUrl; // Use PHP script
                object.type = 'application/pdf';
                object.style.width = '100%';
                object.style.height = '100%';
                object.style.border = 'none';
                
                // Add event listeners
                object.onload = function() {
                    console.log('Object tag loaded successfully');
                };
                
                object.onerror = function() {
                    console.log('Object tag failed, trying embed tag...');
                    loadWithEmbed(container);
                };
                
                // Fallback content for object tag
                object.innerHTML = `
                    <div style="padding: 40px; text-align: center; color: #333; background: #f5f5f5; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                        <i class="fas fa-file-pdf" style="font-size: 3rem; margin-bottom: 20px; color: #7877c6;"></i>
                        <h3 style="margin-bottom: 15px; color: #333;">PDF Viewer Not Supported</h3>
                        <p style="margin-bottom: 20px;">Your browser doesn't support PDF viewing. Please try a different viewer option.</p>
                        <div class="error-actions">
                            <button class="error-btn" onclick="document.getElementById('pdf-viewer-select').value='pdfjs'; loadPDF();">
                                <i class="fas fa-eye"></i>
                                Try PDF.js Viewer
                            </button>
                            <a href="${pdfDirectUrl}" class="error-btn" download>
                                <i class="fas fa-download"></i>
                                Download PDF
                            </a>
                        </div>
                    </div>
                `;
                
                if (container) {
                    container.innerHTML = '';
                    container.appendChild(object);
                } else {
                    viewerArea.innerHTML = '';
                    viewerArea.appendChild(object);
                }
                
                // Check if object loaded successfully
                setTimeout(() => {
                    try {
                        if (object.contentDocument && object.contentDocument.body) {
                            console.log('Object tag loaded successfully');
                            return;
                        } else {
                            throw new Error('Object tag failed to load');
                        }
                    } catch (e) {
                        console.log('Object tag failed, trying embed tag...');
                        loadWithEmbed(container);
                    }
                }, 3000);
                
            } catch (error) {
                console.log('Object tag failed, trying embed tag...');
                loadWithEmbed(container);
            }
        }

        function loadWithEmbed(container = null) {
            const viewerArea = container || document.getElementById('pdf-viewer-area');
            
            try {
                const embed = document.createElement('embed');
                embed.className = 'pdf-viewer';
                embed.src = pdfUrl; // Use PHP script
                embed.type = 'application/pdf';
                embed.style.width = '100%';
                embed.style.height = '100%';
                embed.style.border = 'none';
                
                if (container) {
                    container.innerHTML = '';
                    container.appendChild(embed);
                } else {
                    viewerArea.innerHTML = '';
                    viewerArea.appendChild(embed);
                }
                
                // Check if embed loaded successfully
                setTimeout(() => {
                    try {
                        if (embed.contentDocument && embed.contentDocument.body) {
                            console.log('Embed tag loaded successfully');
                            return;
                        } else {
                            throw new Error('Embed tag failed to load');
                        }
                    } catch (e) {
                        console.log('Embed tag failed, showing error...');
                        showError('Browser PDF viewer is not available. Please try PDF.js Viewer or download the file.');
                    }
                }, 3000);
                
            } catch (error) {
                console.log('Embed tag failed, showing error...');
                showError('Browser PDF viewer is not available. Please try PDF.js Viewer or download the file.');
            }
        }

        function loadWithPDFjs() {
            const viewerArea = document.getElementById('pdf-viewer-area');
            
            // Check if we're running locally
            if (window.location.protocol === 'file:') {
                showError('PDF.js cannot access local files due to browser security restrictions. Please use XAMPP server (http://localhost/links/cv.html) for better PDF viewing.');
                return;
            }
            
            // Load PDF.js dynamically
            if (typeof pdfjsLib === 'undefined') {
                const script = document.createElement('script');
                script.src = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js';
                script.onload = () => {
                    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
                    loadPDFjsViewer();
                };
                script.onerror = () => {
                    showError('PDF.js library failed to load. Please try a different viewer option.');
                };
                document.head.appendChild(script);
            } else {
                loadPDFjsViewer();
            }
        }

        function loadPDFjsViewer() {
            const viewerArea = document.getElementById('pdf-viewer-area');
            
            try {
                // Create PDF.js viewer container
                viewerArea.innerHTML = `
                    <div class="pdfjs-viewer">
                        <div class="pdfjs-controls">
                            <button id="prev-page" disabled>
                                <i class="fas fa-chevron-left"></i> Previous
                            </button>
                            <button id="next-page">
                                Next <i class="fas fa-chevron-right"></i>
                            </button>
                            <span class="pdfjs-page-info">Page <span id="current-page">1</span> of <span id="total-pages">1</span></span>
                            <button id="zoom-in">
                                <i class="fas fa-search-plus"></i> Zoom In
                            </button>
                            <button id="zoom-out">
                                <i class="fas fa-search-minus"></i> Zoom Out
                            </button>
                        </div>
                        <div class="pdfjs-canvas-container" id="pdfjs-canvas-container">
                            <div class="pdf-loading">
                                <div class="spinner"></div>
                                <div>Loading PDF with PDF.js...</div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Initialize PDF.js controls
                initPDFjsControls();
                
                // Try PHP script first, fallback to direct URL
                const urlToUse = pdfUrl;
                
                // Load and render PDF
                pdfjsLib.getDocument(urlToUse).promise.then(doc => {
                    pdfDoc = doc;
                    totalPages = doc.numPages;
                    document.getElementById('total-pages').textContent = totalPages;
                    renderPage(1);
                }).catch(error => {
                    console.error('PDF.js error with PHP script:', error);
                    // Try direct URL as fallback
                    console.log('Trying direct PDF URL as fallback...');
                    pdfjsLib.getDocument(pdfDirectUrl).promise.then(doc => {
                        pdfDoc = doc;
                        totalPages = doc.numPages;
                        document.getElementById('total-pages').textContent = totalPages;
                        renderPage(1);
                    }).catch(fallbackError => {
                        console.error('PDF.js error with direct URL:', fallbackError);
                        // Try to provide specific error messages
                        if (fallbackError.name === 'MissingPDFException') {
                            showError('PDF file not found. Please check if the file exists and try again.');
                        } else if (fallbackError.name === 'InvalidPDFException') {
                            showError('The PDF file appears to be corrupted or invalid. Please try a different viewer option.');
                        } else if (fallbackError.name === 'UnexpectedResponseException') {
                            showError('Server error while loading PDF. Please try a different viewer option or check your connection.');
                        } else {
                            showError('PDF.js failed to load the PDF. Please try a different viewer option.');
                        }
                    });
                });
                
            } catch (error) {
                console.error('PDF.js error:', error);
                showError('PDF.js failed to initialize. Please try a different viewer option.');
            }
        }

        function initPDFjsControls() {
            document.getElementById('prev-page').addEventListener('click', () => {
                if (currentPage > 1) {
                    renderPage(currentPage - 1);
                }
            });

            document.getElementById('next-page').addEventListener('click', () => {
                if (currentPage < totalPages) {
                    renderPage(currentPage + 1);
                }
            });

            document.getElementById('zoom-in').addEventListener('click', () => {
                renderPage(currentPage, 1.2);
            });

            document.getElementById('zoom-out').addEventListener('click', () => {
                renderPage(currentPage, 0.8);
            });
        }

        function renderPage(pageNum, zoomFactor = 1) {
            if (!pdfDoc) return;
            
            currentPage = pageNum;
            const container = document.getElementById('pdfjs-canvas-container');
            const scale = 1.5 * zoomFactor;
            
            // Update page info
            document.getElementById('current-page').textContent = currentPage;
            document.getElementById('prev-page').disabled = currentPage <= 1;
            document.getElementById('next-page').disabled = currentPage >= totalPages;
            
            // Clear container
            container.innerHTML = '';
            
            // Render page
            pdfDoc.getPage(currentPage).then(page => {
                const viewport = page.getViewport({ scale: scale });
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                canvas.width = viewport.width;
                canvas.height = viewport.height;
                
                const renderContext = {
                    canvasContext: ctx,
                    viewport: viewport
                };
                
                const pageDiv = document.createElement('div');
                pageDiv.className = 'pdfjs-page';
                pageDiv.appendChild(canvas);
                container.appendChild(pageDiv);
                
                page.render(renderContext).promise.then(() => {
                    console.log(`Page ${currentPage} rendered successfully`);
                }).catch(error => {
                    console.error('Page render error:', error);
                });
            }).catch(error => {
                console.error('Page load error:', error);
                showError('Failed to load page. Please try reloading.');
            });
        }

        function loadWithGoogleDocs() {
            const viewerArea = document.getElementById('pdf-viewer-area');
            
            try {
                // Check if we're running locally
                if (window.location.protocol === 'file:') {
                    showError('Google Docs Viewer cannot access local files. Please use XAMPP server or try a different viewer option.');
                    return;
                }
                
                // For server-based files, use Google Docs Viewer
                const fullUrl = window.location.origin + '/' + pdfUrl;
                const googleDocsUrl = `https://docs.google.com/viewer?url=${encodeURIComponent(fullUrl)}&embedded=true`;
                
                const iframe = document.createElement('iframe');
                iframe.className = 'pdf-viewer';
                iframe.src = googleDocsUrl;
                iframe.style.width = '100%';
                iframe.style.height = '100%';
                iframe.style.border = 'none';
                iframe.style.background = '#ffffff';
                
                viewerArea.innerHTML = '';
                viewerArea.appendChild(iframe);
                
                // Check if Google Docs loaded successfully
                setTimeout(() => {
                    try {
                        if (iframe.contentDocument && iframe.contentDocument.body) {
                            console.log('Google Docs loaded successfully');
                            return;
                        } else {
                            throw new Error('Google Docs failed to load');
                        }
                    } catch (e) {
                        console.log('Google Docs failed, showing error...');
                        showError('Google Docs Viewer failed to load. Please try a different viewer option.');
                    }
                }, 5000);
                
            } catch (error) {
                console.log('Google Docs failed, showing error...');
                showError('Google Docs Viewer failed to load. Please try a different viewer option.');
            }
        }

        function loadWithDirectLink() {
            const viewerArea = document.getElementById('pdf-viewer-area');
            
            viewerArea.innerHTML = `
                <div class="pdf-error">
                    <i class="fas fa-external-link-alt"></i>
                    <h3>Direct PDF Link</h3>
                    <p>Click the button below to open the PDF directly in your browser or download it.</p>
                    <div class="error-actions">
                        <a href="${pdfUrl}" class="error-btn" target="_blank">
                            <i class="fas fa-external-link-alt"></i>
                            Open PDF Directly
                        </a>
                        <a href="${pdfDirectUrl}" class="error-btn" download>
                            <i class="fas fa-download"></i>
                            Download PDF
                        </a>
                    </div>
                </div>
            `;
        }

        function toggleFullscreen() {
            const viewerArea = document.getElementById('pdf-viewer-area');
            
            if (!document.fullscreenElement) {
                viewerArea.requestFullscreen().catch(err => {
                    console.log('Error attempting to enable fullscreen:', err);
                });
            } else {
                document.exitFullscreen();
            }
        }

        function showError(message) {
            const viewerArea = document.getElementById('pdf-viewer-area');
            const isLocalFile = window.location.protocol === 'file:';
            const isXAMPP = window.location.hostname === 'localhost' && window.location.port === '';
            
            let errorMessage = message;
            let actionButtons = `
                <button class="error-btn" onclick="document.getElementById('pdf-viewer-select').value='browser'; loadPDF();">
                    <i class="fas fa-globe"></i>
                    Try Browser Default
                </button>
                <button class="error-btn" onclick="document.getElementById('pdf-viewer-select').value='pdfjs'; loadPDF();">
                    <i class="fas fa-eye"></i>
                    Try PDF.js Viewer
                </button>
                <a href="${pdfDirectUrl}" class="error-btn" download>
                    <i class="fas fa-download"></i>
                    Download PDF
                </a>
            `;
            
            // Add specific guidance based on environment
            if (isLocalFile) {
                errorMessage += '<br><br><strong>ðŸ’¡ Tip:</strong> For better PDF viewing, use XAMPP server:';
                actionButtons = `
                    <button class="error-btn" onclick="window.open('http://localhost/links/cv.html', '_self');">
                        <i class="fas fa-server"></i>
                        Open with XAMPP
                    </button>
                    <a href="${pdfDirectUrl}" class="error-btn" download>
                        <i class="fas fa-download"></i>
                        Download PDF
                    </a>
                `;
            } else if (isXAMPP) {
                errorMessage += '<br><br><strong>ðŸ’¡ Tip:</strong> You are using XAMPP server. Try switching between viewer options above.';
            }
            
            viewerArea.innerHTML = `
                <div class="pdf-error">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h3>PDF Loading Error</h3>
                    <p>${errorMessage}</p>
                    <div class="error-actions">
                        ${actionButtons}
                    </div>
                </div>
            `;
        }
    </script>
    
    <!-- NoScript Fallback -->
    <noscript>
        <style>
            .loading-screen { display: none !important; }
            .cv-container { opacity: 1 !important; visibility: visible !important; }
        </style>
    </noscript>
</body>
</html> 